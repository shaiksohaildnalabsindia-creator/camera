<select id="trackingSelect">
  <option value="">Select Tracking Number</option>
</select>

<br><br>

<input type="file" id="cameraInput" accept="image/*" capture="environment">
<button onclick="upload()">Upload</button>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw6cZSp4kr_Bck0joVBAShfKMpd1zTwxPD3topY1cQNzoK4AeaxuRZ0TsJZJUsq8txUdw/exec/exec";

// Load today's tracking numbers
fetch(WEB_APP_URL)
  .then(r => r.json())
  .then(data => {
    const select = document.getElementById("trackingSelect");
    data.forEach(tracking => {
      const option = document.createElement("option");
      option.value = tracking;
      option.textContent = tracking;
      select.appendChild(option);
    });
  })
  .catch(console.error);

function upload() {
  const fileInput = document.getElementById("cameraInput");
  const tracking = document.getElementById("trackingSelect").value;

  if (!tracking) return alert("Select a tracking number");
  if (!fileInput.files[0]) return alert("Select an image");

  const reader = new FileReader();
  reader.onload = function(e) {
    fetch(WEB_APP_URL, {
      method: "POST",
      body: new URLSearchParams({
        image: e.target.result,
        tracking: tracking
      })
    })
    .then(r => r.text())
    .then(msg => alert(msg))
    .catch(console.error);
  };
  reader.readAsDataURL(fileInput.files[0]);
}
</script>
